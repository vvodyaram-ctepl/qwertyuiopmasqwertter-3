<div class="content-block">
    <div class="row mb-3">
        <div class="col-7">
            <div class="d-inline-block mr-3">
                <input type="radio" id="existing_Question" (change)="formReset('editQues')" name="isExist"
                    [(ngModel)]="isExistQues" [value]="1">
                &nbsp;<label for="existing_Question">Select Predefined Question(s)</label><br>
            </div>
            <div class="d-inline-block">
                <input type="radio" id="new_Question" (change)="formReset('addQues')" name="isExist"
                    [(ngModel)]="isExistQues" [value]="2">
                &nbsp;<label for="new_Question">Add New Question</label><br>
            </div>
        </div>
        <div class="col-4 text-right">
            <div class="checkbox-wrapper">
                <label>
                    <input type="checkbox" class="check checkbox-width-20" [(ngModel)]="includeAll"
                        (change)="checkIncludeDataExtract()" />
                    <span class="label">
                        Include all questions in Data Extract
                    </span>
                </label>
            </div>
        </div>
    </div>

    <div *ngIf="isExistQues == 1">
        <div class="row">
            <div class="col-md-6">
                <p class="quesType">Predefined Question(s)</p>
                <div class="search-wrapper">
                    <input type="text" placeholder="Search Question" [(ngModel)]="searchText" class="search-box"
                        (keydown.enter)="getPreDefinedQuestions()">
                    <div class="icon-circle" style="cursor:pointer;" (click)="getPreDefinedQuestions()">
                        <i class="icon-search"></i>
                    </div>
                </div>
                <div class="preDefinedQuestion">
                    <div *ngIf="!preDefinedQuestions.length" class="my-2 text-center blue-hdr">No records found</div>
                    <ngb-accordion [closeOthers]="true" [sortablejs]="preDefinedQuestions"
                        [sortablejsOptions]="options1">
                        <ngb-panel id="{{i}}" *ngFor="let ques of preDefinedQuestions; let i = index">
                            <ng-template ngbPanelTitle>
                                <div class="row">
                                    <div class="col-1 px-1">
                                        <div class="acronym" *ngIf="ques.questionTypeId == 1">LIST</div>
                                        <div class="acronym" *ngIf="ques.questionTypeId == 2">RB</div>
                                        <div class="acronym" *ngIf="ques.questionTypeId == 3">MCQ</div>
                                        <div class="acronym" *ngIf="ques.questionTypeId == 4">TB</div>
                                        <div class="acronym" *ngIf="ques.questionTypeId == 5">TA</div>
                                        <div class="acronym" *ngIf="ques.questionTypeId == 6">SS</div>
                                        <div class="acronym" *ngIf="ques.questionTypeId == 7">IMG</div>
                                        <div class="acronym" *ngIf="ques.questionTypeId == 8">VID</div>
                                        <div class="acronym" *ngIf="ques.questionTypeId == 9">DATE</div>
                                    </div>
                                    <div class="col-10">{{ques.preDefinedQuestion}} <br>
                                        <img *ngIf="ques.questionImageUrl" [src]="ques.questionImageUrl"
                                            class="img-fluid ml-3 mt-1" width="50px">
                                    </div>
                                    <div class="col-1 downArrow text-right"><i class="icon-right-arrow"></i></div>
                                </div>
                            </ng-template>
                            <ng-template ngbPanelContent>
                                <div class="row" *ngIf="ques.questionTypeId == 1">
                                    <div class="dropdown col-12">
                                        <select class="form-control">
                                            <option *ngFor="let opt of ques.questionAnswerOptions">
                                                {{opt.questionAnswer}}</option> <!-- <br>
                                            <img *ngIf="opt?.ansOptionMediaUrl" [src]="opt?.ansOptionMediaUrl"
                                                class="img-fluid ml-3 mt-1" width="50px"> -->
                                        </select>
                                    </div>
                                </div>
                                <div
                                    *ngIf="ques.questionTypeId == 2 || ques.questionTypeId == 3 || ques.questionTypeId == 6">
                                    <div class="row" *ngFor="let opt of ques.questionAnswerOptions">
                                        <div class="col-12">
                                            <div class="radio-input-wrapper" *ngIf="ques.questionTypeId == 2">
                                                <label>
                                                    <input type="radio" class="radio" disabled />
                                                    <span class="label">
                                                        {{opt.questionAnswer}} <br>
                                                        <img *ngIf="opt?.ansOptionMediaUrl"
                                                            [src]="opt?.ansOptionMediaUrl" class="img-fluid ml-3 mt-1"
                                                            width="50px">
                                                    </span>
                                                </label>
                                            </div>

                                            <div class="checkbox-wrapper" *ngIf="ques.questionTypeId == 3">
                                                <label>
                                                    <input type="checkbox" class="check checkbox-width-20" disabled />
                                                    <span class="label">
                                                        {{opt.questionAnswer}} <br>
                                                        <img *ngIf="opt?.ansOptionMediaUrl"
                                                            [src]="opt?.ansOptionMediaUrl" class="img-fluid ml-3 mt-1"
                                                            width="50px">
                                                    </span>
                                                </label>
                                            </div>

                                            <div class="row" *ngIf="ques.questionTypeId == 6">
                                                <div class="col-3 m-auto">
                                                    {{opt.questionAnswer}}
                                                </div>
                                                <div class="col-9">
                                                    <div class="custom-slider"
                                                        [ngClass]="ques.other.isVerticalScale ? 'vertical' : ''">
                                                        <ngx-slider [value]="ques.other.floor"
                                                            [options]="ques.other"></ngx-slider>
                                                        <p class="floorDesc">{{ques.other.floorDescription}}</p>
                                                        <p class="ceilDesc">{{ques.other.ceilDescription}}</p>
                                                        <!-- Used legends for showing tickstep values, as tickstepvalues: true not working if the floor value does not start with 0. Hence used legends for showing tick steps. Also, floorDescription and ceilDescription are legends, but defined custom css as the legends are used to display the tick steps and also if we put the descriptions in legends, it does not work for continuous scales -->
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row"
                                    *ngIf="ques.questionTypeId == 4 || ques.questionTypeId == 5 || ques.questionTypeId == 9">
                                    <div class="col-12">
                                        <div class="text" *ngIf="ques.questionTypeId == 4">
                                            <label>
                                                <input type="text" class="form-control d-inline-block" readonly>
                                            </label>
                                        </div>

                                        <div class="text" *ngIf="ques.questionTypeId == 5">
                                            <label>
                                                <textarea class="form-control d-inline-block" readonly></textarea>
                                            </label>
                                        </div>

                                        <div class="text" *ngIf="ques.questionTypeId == 9">
                                            <label>
                                                <input type="text" placeholder="MM-DD-YYYY"
                                                    class="form-control d-inline-block" readonly>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <div class="row" *ngIf="ques.questionTypeId == 7 || ques.questionTypeId == 8">
                                    <div class="col-12">
                                        <div class="cloud-img ml-4"><i class="icon-upload size-30"></i></div>
                                    </div>
                                </div>
                            </ng-template>
                        </ngb-panel>
                    </ngb-accordion>
                </div>
            </div>

            <div class="col-md-6">
                <p class="quesType">Selected Question(s)</p>
                <ul class="list-group sortable selectedQuestion" [sortablejs]="selectedQuestions"
                    [sortablejsOptions]="options2">
                    <li class="list-group-item" *ngFor="let ques of selectedQuestions; let i = index">
                        <span>{{ ques.preDefinedQuestion }}</span>
                        <span class="float-right">
                            <span class="icon-tag size-20" title="Edit"
                                (click)="editPreDefinedQuestion(ques, i)"></span>&nbsp;&nbsp;
                            <span class="fa fa-trash-alt" style="position: relative; bottom: 3px; font-size: 14px;"
                                title="Delete" (click)="delPreDefinedQuestion(i)"></span>
                        </span>
                    </li>
                </ul>
            </div>
        </div>
        <div class="row">
            <form class="editQues mt-4 col-12" [formGroup]="editQuesForm" *ngIf="isEditPreDefined">
                <div class="ques">
                    <div class="ques-name p-3">
                        <div class="row">
                            <div class="col-8">
                                <input type="text-box" class="form-control" formControlName="preDefinedQuestion"
                                    placeholder="Enter Question (Required)">
                            </div>
                            <div class="col-4 dropdown">
                                <select class="form-control w-100" formControlName="questionTypeId"
                                    (change)="typeChanged(editQuesForm.value.questionTypeId, 'editQues')">
                                    <option *ngFor="let type of questionTypes" [ngValue]="type.questionTypeId">
                                        {{type.questionType}}</option>
                                </select>
                            </div>
                            <validation-message class="ml-3 mb-2" [control]="editQuesForm.controls.preDefinedQuestion">
                            </validation-message>
                        </div>
                        <div class="row mb-2">
                            <div class="mb-2 col-8">
                                <div class="checkbox-wrapper">
                                    <label>
                                        <input type="checkbox" class="check checkbox-width-20"
                                            formControlName="isQuesImg" (change)="removeQuesImg()" />
                                        <span class="label">
                                            Add Image
                                        </span>
                                    </label>
                                </div>
                            </div>
                            <div class="col-4 mb-2 dropdown" *ngIf="sections.length">
                                <select class="form-control w-100" formControlName="section">
                                    <option [ngValue]="null">Select Section</option>
                                    <option *ngFor="let section of sections" [ngValue]="section">
                                        {{section.sectionName}}</option>
                                </select>
                            </div>
                            <div class="col-12" *ngIf="editQuesForm.value.isQuesImg">
                                <app-file-upload formControlName="file" [fileLength]="1"
                                    [validTypes]="['jpg', 'jpeg', 'png', 'svg']"
                                    [filesUploaded]="editQuesForm.value.quesImg"
                                    (selectedItem)="selectQuesFileResult($event)">
                                </app-file-upload>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-4">
                                <div class="checkbox-wrapper">
                                    <label>
                                        <input type="checkbox" class="check checkbox-width-20"
                                            formControlName="isIncludeInDataExtract" (change)="verifyisAllInclude()" />
                                        <span class="label">
                                            Include In Data Extract
                                        </span>
                                    </label>
                                </div>
                            </div>

                            <div class="col-4">
                                <div class="d-flex">
                                    <input type="text" class="form-control w-75" formControlName="validityPeriod"
                                        placeholder="Validity"
                                        [readOnly]="!editQuesForm.value.isIncludeInDataExtract">&nbsp;
                                    <span class="mt-2">days</span>
                                </div>
                                <validation-message class="d-block" [control]="editQuesForm.controls.validityPeriod">
                                </validation-message>
                            </div>

                            <div class="col-4">
                                <div class="checkbox-wrapper"
                                    *ngIf="editQuesForm.value.questionTypeId == 1 || editQuesForm.value.questionTypeId == 2 || editQuesForm.value.questionTypeId == 3">
                                    <label>
                                        <input type="checkbox" class="check checkbox-width-20"
                                            formControlName="suffleOptionOrder" />
                                        <span class="label">
                                            Shuffle Option Order
                                        </span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="ques-other p-3" *ngIf="editQuesForm.value.questionTypeId == 6">
                        <div formGroupName="other">
                            <div class="row px-4 pb-3">
                                <div class="col-4">
                                    <div class="checkbox-wrapper">
                                        <label>
                                            <input type="checkbox" class="check checkbox-width-20"
                                                formControlName="isVerticalScale" />
                                            <span class="label">
                                                Vertical Scale
                                            </span>
                                        </label>
                                    </div>
                                </div>
                                <div class="col-4">
                                    <div class="checkbox-wrapper">
                                        <label>
                                            <input type="checkbox" class="check checkbox-width-20"
                                                formControlName="isContinuousScale"
                                                (change)="minMaxCompare(editQuesForm)" />
                                            <span class="label">
                                                Continuous Scale
                                            </span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="row px-4">
                                <div class="col-4">
                                    <div class="row mb-2">
                                        <div class="col-6 m-auto">Minimum Value</div>
                                        <div class="col-6">
                                            <input type="number" min="0" formControlName="floor"
                                                class="form-control d-inline-block mb-1"
                                                (input)="minMaxCompare(editQuesForm)">
                                            <validation-message [control]="editQuesForm.controls.other.controls.floor">
                                            </validation-message>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-8">
                                    <div class="row mb-2">
                                        <div class="col-5 m-auto">Minimum Value Description</div>
                                        <div class="col-7">
                                            <input type="text" formControlName="floorDescription"
                                                class="form-control d-inline-block mb-1" maxLength="15">
                                            <validation-message
                                                [control]="editQuesForm.controls.other.controls.floorDescription">
                                            </validation-message>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-4">
                                    <div class="row mb-2">
                                        <div class="col-6 m-auto">Maximum Value</div>
                                        <div class="col-6">
                                            <input type="number" min="1" formControlName="ceil"
                                                class="form-control d-inline-block mb-1"
                                                (input)="minMaxCompare(editQuesForm)">
                                            <validation-message [control]="editQuesForm.controls.other.controls.ceil">
                                            </validation-message>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-8">
                                    <div class="row mb-2">
                                        <div class="col-5 m-auto">Maximum Value Description</div>
                                        <div class="col-7">
                                            <input type="text" formControlName="ceilDescription"
                                                class="form-control d-inline-block mb-1" maxLength="15">
                                            <validation-message
                                                [control]="editQuesForm.controls.other.controls.ceilDescription">
                                            </validation-message>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-4">
                                    <div class="row mb-2">
                                        <div class="col-6 m-auto">Step Value</div>
                                        <div class="col-6">
                                            <input type="number" formControlName="tickStep"
                                                class="form-control d-inline-block mb-1"
                                                (input)="stepValidation(editQuesForm)">
                                            <validation-message
                                                [control]="editQuesForm.controls.other.controls.tickStep">
                                            </validation-message>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="ques-opt p-3">
                        <!-- Loop options for Dropdown, radio button, checkboxes and slider -->
                        <div formArrayName="questionAnswerOptions"
                            *ngFor="let opt of editQuesForm.get('questionAnswerOptions')['controls']; let i = index;">
                            <!-- For all the options except others, specify and none of the above -->
                            <div class="row"
                                *ngIf="(opt.value.questionAnswer != otherSpecifyText && opt.value.questionAnswer != noneOfTheAboveText && (editQuesForm.value.questionTypeId == 1 || editQuesForm.value.questionTypeId == 2 || editQuesForm.value.questionTypeId == 3))"
                                [formGroupName]="i">
                                <div class="col-11 ml-3">
                                    <div class="row mx-2 px-3 option-border">
                                        <div class="pl-0 mb-3 col-10">
                                            <div class="dropdown slider" *ngIf="editQuesForm.value.questionTypeId == 1">
                                                <label>
                                                    <input type="text" class="form-control d-inline-block mb-2"
                                                        formControlName="questionAnswer"
                                                        placeholder="Enter Option (Required)"
                                                        (input)="checkIfNoneOrOthers(i)">
                                                    <validation-message [control]="opt.controls.questionAnswer">
                                                    </validation-message>
                                                </label>
                                            </div>

                                            <div class="radio-input-wrapper"
                                                *ngIf="editQuesForm.value.questionTypeId == 2">
                                                <label>
                                                    <input type="radio" class="radio" disabled>
                                                    <span class="label">
                                                        <input type="text" class="form-control d-inline-block mb-2"
                                                            formControlName="questionAnswer"
                                                            placeholder="Enter Option (Required)"
                                                            (input)="checkIfNoneOrOthers(i)">
                                                    </span>
                                                    <validation-message [control]="opt.controls.questionAnswer">
                                                    </validation-message>
                                                </label>
                                            </div>

                                            <div class="checkbox-wrapper"
                                                *ngIf="editQuesForm.value.questionTypeId == 3">
                                                <label>
                                                    <input type="checkbox" class="check checkbox-width-20" disabled />
                                                    <span class="label">
                                                        <input type="text" class="form-control d-inline-block mb-2"
                                                            formControlName="questionAnswer"
                                                            placeholder="Enter Option (Required)"
                                                            (input)="checkIfNoneOrOthers(i)">
                                                    </span>
                                                    <validation-message [control]="opt.controls.questionAnswer">
                                                    </validation-message>
                                                </label>
                                            </div>
                                        </div>
                                        <!-- To add image to option start -->
                                        <div class="col-2 mb-3" *ngIf="editQuesForm.value.questionTypeId != 1">
                                            <div class="checkbox-wrapper">
                                                <label>
                                                    <input type="checkbox" class="check checkbox-width-20"
                                                        formControlName="isOptImg" (change)="removeQuesAnsImg(i)" />
                                                    <span class="label">
                                                        Add Image
                                                    </span>
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-12 mb-3 px-0"
                                            *ngIf="editQuesForm.value.questionAnswerOptions[i].isOptImg">
                                            <app-file-upload formControlName="file" [fileLength]="1"
                                                [validTypes]="['jpg', 'jpeg', 'png', 'svg']"
                                                [filesUploaded]="opt.value.optImg"
                                                (selectedItem)="selectQuesAnsFileResult($event, i)">
                                            </app-file-upload>
                                        </div>
                                        <!-- To add image to option end -->
                                        <div class="col-4 mb-2 pl-0" *ngIf="editQuesForm.value.questionTypeId != 3">
                                            <div class="checkbox-wrapper">
                                                <label>
                                                    <input type="checkbox" class="check checkbox-width-20"
                                                        formControlName="submitQuestionnaire"
                                                        (change)="checkIfAllOptionsSelectedForSubmit('editQues', i)" />
                                                    <span class="label">
                                                        Submit Questionnaire
                                                    </span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col p-1 m-auto">
                                    <div class=" card icon-card-list red-bg mr-1" title="Remove"
                                        *ngIf="editQuesForm.value.questionAnswerOptions.length > 1">
                                        <span class="pointer-cursor size-15" title="Remove"
                                            (click)="removeQuesAns('editQues', i)">-</span>
                                    </div>

                                    <div class="card icon-card-list blue-bg" title="Add"
                                        *ngIf="(i + 1 == editQuesForm.value.questionAnswerOptions.length - 2)">
                                        <!-- i + 1 == opt.value.length - 2 indicates last option other than "others, specify and none of the above" -->
                                        <span class="fa fa-plus pointer-cursor size-14" style="color:white;" title="Add"
                                            (click)="addQuesAns('editQues')"></span>
                                    </div>
                                </div>
                            </div>
                            <!-- For the options "others, specify and none of the above" - we have to disable the options and should not allow the actions like add and remove at the end of the option -->
                            <div class="row"
                                *ngIf="(opt.value.questionAnswer == otherSpecifyText || opt.value.questionAnswer == noneOfTheAboveText && (editQuesForm.value.questionTypeId == 1 || editQuesForm.value.questionTypeId == 2 || editQuesForm.value.questionTypeId == 3))"
                                [formGroupName]="i">
                                <div class="col-11 ml-3">
                                    <div class="row mx-2 px-3 option-border">
                                        <div class="px-0 mb-3 col-10 pr-2">
                                            <div class="checkbox-wrapper">
                                                <label>
                                                    <input type="checkbox" formControlName="isOption"
                                                        class="check checkbox-width-20"
                                                        (change)="noneOrOthers('editQues', i)" />
                                                    <span class="label">
                                                        <input type="text" class="form-control d-inline-block mb-2"
                                                            formControlName="questionAnswer" disabled>
                                                    </span>
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-4 mb-2 pl-0"
                                            *ngIf="opt.value.isOption && opt.value.questionAnswer == noneOfTheAboveText && editQuesForm.value.questionTypeId != 3">
                                            <div class="checkbox-wrapper">
                                                <label>
                                                    <input type="checkbox" class="check checkbox-width-20"
                                                        formControlName="submitQuestionnaire"
                                                        (change)="checkIfAllOptionsSelectedForSubmit('editQues', i)" />
                                                    <span class="label">
                                                        Submit Questionnaire
                                                    </span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- slider -->
                            <div class="row" *ngIf="editQuesForm.value.questionTypeId == 6" [formGroupName]="i">
                                <div class="col-11">
                                    <div class="dropdown slider">
                                        <label class="ml-4">
                                            <input type="text" class="form-control d-inline-block mb-2"
                                                formControlName="questionAnswer" placeholder="Enter Option (Required)"
                                                (input)="checkIfNoneOrOthers(i)">
                                            <validation-message [control]="opt.controls.questionAnswer">
                                            </validation-message>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- other options -->
                        <div class="row"
                            *ngIf="editQuesForm.value.questionTypeId == 4 || editQuesForm.value.questionTypeId == 5 || editQuesForm.value.questionTypeId == 7 || editQuesForm.value.questionTypeId == 8 || editQuesForm.value.questionTypeId == 9">
                            <div class="col-11">
                                <div class="text" *ngIf="editQuesForm.value.questionTypeId == 4">
                                    <label class="ml-4">
                                        <input type="text" class="form-control d-inline-block" disabled>
                                    </label>
                                </div>

                                <div class="text" *ngIf="editQuesForm.value.questionTypeId == 5">
                                    <label class="ml-4">
                                        <textarea class="form-control d-inline-block" disabled></textarea>
                                    </label>
                                </div>

                                <div class="text" *ngIf="editQuesForm.value.questionTypeId == 9">
                                    <label class="ml-4">
                                        <input type="text" placeholder="MM-DD-YYYY" class="form-control d-inline-block"
                                            disabled>
                                    </label>
                                </div>

                                <div class="upload"
                                    *ngIf="editQuesForm.value.questionTypeId == 7 || editQuesForm.value.questionTypeId == 8">
                                    <app-file-upload [disableBtn]="true">
                                    </app-file-upload>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="ques-footer p-3">
                        <div class="row">
                            <div class="col-6">
                                <div class="mb-1">
                                    <div class="checkbox-wrapper">
                                        <label>
                                            <input type="checkbox" class="check checkbox-width-20"
                                                formControlName="isMandatory" />
                                            <span class="label">
                                                Mark this question as mandatory
                                            </span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div>
                    <button class="btn btn-primary float-right mt-2" type="button"
                        (click)="updateSelectedQues()">Save</button>
                </div>
            </form>
        </div>
    </div>

    <div *ngIf="isExistQues == 2">
        <form class="addQues" [formGroup]="addQuesForm">
            <div class="row mt-2" formArrayName="questions"
                *ngFor="let ques of addQuesForm.get('questions')['controls']; let i = index; let last = last">
                <div class="col-11">
                    <div class="ques" [formGroupName]="i">
                        <div class="ques-name p-3">
                            <div class="row">
                                <div class="col-8 mb-2" style="display: inherit;">
                                    <span class="ques-number mt-2">Q{{i+1}}&nbsp;</span>
                                    <input type="text" class="form-control ml-1 d-inline-block"
                                        formControlName="preDefinedQuestion" placeholder="Enter Question (Required)"
                                        (input)="quesUpdated(i)">
                                </div>

                                <div class="col-4 mb-2 dropdown">
                                    <select class="form-control w-100" formControlName="questionTypeId"
                                        (change)="typeChanged(addQuesForm.value.questions[i].questionTypeId, 'addQues', i)">
                                        <option *ngFor="let type of questionTypes" [ngValue]="type.questionTypeId">
                                            {{type.questionType}}</option>
                                    </select>
                                </div>
                                <validation-message class="ml-3 mb-2" [control]="ques.controls.preDefinedQuestion">
                                </validation-message>
                            </div>
                            <div class="row pl-28px mb-2">
                                <div class="mb-2 col-8">
                                    <div class="checkbox-wrapper">
                                        <label>
                                            <input type="checkbox" class="check checkbox-width-20"
                                                formControlName="isQuesImg" (change)="removeQuesImg(i)" />
                                            <span class="label">
                                                Add Image
                                            </span>
                                        </label>
                                    </div>
                                </div>

                                <div class="col-4 dropdown pl-0 mb-2" *ngIf="sections.length">
                                    <select class="form-control w-100" formControlName="section"
                                        (change)="quesUpdated(i)">
                                        <option [ngValue]="null">Select Section</option>
                                        <option *ngFor="let section of sections; let j = index" [ngValue]="section">
                                            {{section.sectionName}}</option>
                                    </select>
                                </div>

                                <div class="col-12" *ngIf="addQuesForm.value.questions[i].isQuesImg">
                                    <app-file-upload formControlName="file" [fileLength]="1"
                                        [validTypes]="['jpg', 'jpeg', 'png', 'svg']"
                                        [filesUploaded]="ques.value.quesImg"
                                        (selectedItem)="selectQuesFileResult($event, i)">
                                    </app-file-upload>
                                </div>
                            </div>
                            <div class="row pl-28px">
                                <div class="col-4">
                                    <div class="checkbox-wrapper">
                                        <label>
                                            <input type="checkbox" class="check checkbox-width-20"
                                                formControlName="isIncludeInDataExtract"
                                                (change)="quesUpdated(i); verifyisAllInclude(i)" />
                                            <span class="label">
                                                Include In Data Extract
                                            </span>
                                        </label>
                                    </div>
                                </div>

                                <div class="col-4">
                                    <div class="d-flex">
                                        <input type="text" class="form-control w-75" formControlName="validityPeriod"
                                            placeholder="Validity" (input)="quesUpdated(i)"
                                            [readOnly]="!ques.value.isIncludeInDataExtract">&nbsp;
                                        <span class="mt-2">days</span>
                                    </div>
                                    <validation-message class="d-block" [control]="ques.controls.validityPeriod">
                                    </validation-message>
                                </div>

                                <div class="col-4 pl-0"
                                    *ngIf="ques.value.questionTypeId == 1 || ques.value.questionTypeId == 2 || ques.value.questionTypeId == 3">
                                    <div class="checkbox-wrapper">
                                        <label>
                                            <input type="checkbox" class="check checkbox-width-20"
                                                formControlName="suffleOptionOrder" (change)="quesUpdated(i)" />
                                            <span class="label">
                                                Shuffle Option Order
                                            </span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="ques-other p-3" *ngIf="ques.value.questionTypeId == 6">
                            <div formGroupName="other">
                                <div class="row px-4 pb-3">
                                    <div class="col-4">
                                        <div class="checkbox-wrapper">
                                            <label>
                                                <input type="checkbox" class="check checkbox-width-20"
                                                    formControlName="isVerticalScale" (change)="quesUpdated(i)" />
                                                <span class="label">
                                                    Vertical Scale
                                                </span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <div class="checkbox-wrapper">
                                            <label>
                                                <input type="checkbox" class="check checkbox-width-20"
                                                    formControlName="isContinuousScale"
                                                    (change)="quesUpdated(i);minMaxCompare(ques)" />
                                                <span class="label">
                                                    Continuous Scale
                                                </span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <div class="row px-4">
                                    <div class="col-4">
                                        <div class="row mb-2">
                                            <div class="col-6 m-auto">Minimum Value</div>
                                            <div class="col-6">
                                                <input type="number" min="0" formControlName="floor"
                                                    class="form-control d-inline-block mb-1"
                                                    (input)="minMaxCompare(ques); quesUpdated(i)">
                                                <validation-message [control]="ques.controls.other.controls.floor">
                                                </validation-message>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-8">
                                        <div class="row mb-2">
                                            <div class="col-5 m-auto">Minimum Value Description</div>
                                            <div class="col-7">
                                                <input type="text" formControlName="floorDescription"
                                                    class="form-control d-inline-block mb-1" (input)="quesUpdated(i)"
                                                    maxLength="15">
                                                <validation-message
                                                    [control]="ques.controls.other.controls.floorDescription">
                                                </validation-message>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <div class="row mb-2">
                                            <div class="col-6 m-auto">Maximum Value</div>
                                            <div class="col-6">
                                                <input type="number" min="1" formControlName="ceil"
                                                    class="form-control d-inline-block mb-1"
                                                    (input)="minMaxCompare(ques); quesUpdated(i)">
                                                <validation-message [control]="ques.controls.other.controls.ceil">
                                                </validation-message>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-8">
                                        <div class="row mb-2">
                                            <div class="col-5 m-auto">Maximum Value Description</div>
                                            <div class="col-7">
                                                <input type="text" formControlName="ceilDescription"
                                                    class="form-control d-inline-block mb-1" (input)="quesUpdated(i)"
                                                    maxLength="15">
                                                <validation-message
                                                    [control]="ques.controls.other.controls.ceilDescription">
                                                </validation-message>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <div class="row mb-2">
                                            <div class="col-6 m-auto">Step Value</div>
                                            <div class="col-6">
                                                <input type="number" formControlName="tickStep"
                                                    class="form-control d-inline-block mb-1"
                                                    (input)="stepValidation(ques); quesUpdated(i)">
                                                <validation-message [control]="ques.controls.other.controls.tickStep">
                                                </validation-message>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="ques-opt p-3">
                            <!-- Loop options for Dropdown, radio button, checkboxes and slider -->
                            <div formArrayName="questionAnswerOptions"
                                *ngFor="let opt of ques.get('questionAnswerOptions')['controls']; let j = index;">
                                <!-- For all the options except others, specify and none of the above -->
                                <div class="row"
                                    *ngIf="(opt.value.questionAnswer != otherSpecifyText && opt.value.questionAnswer != noneOfTheAboveText && (ques.value.questionTypeId == 1 || ques.value.questionTypeId == 2 || ques.value.questionTypeId == 3))"
                                    [formGroupName]="j">
                                    <div class="col-11 ml-3">
                                        <div class="row mx-2 px-3 option-border">
                                            <div class="pl-0 mb-3 col-10">
                                                <div class="dropdown slider" *ngIf="ques.value.questionTypeId == 1">
                                                    <label>
                                                        <input type="text" class="form-control d-inline-block mb-2"
                                                            formControlName="questionAnswer"
                                                            placeholder="Enter Option (Required)"
                                                            (input)="checkIfNoneOrOthers(j, i);quesUpdated(i)">
                                                        <validation-message [control]="opt.controls.questionAnswer">
                                                        </validation-message>
                                                    </label>
                                                </div>

                                                <div class="radio-input-wrapper" *ngIf="ques.value.questionTypeId == 2">
                                                    <label>
                                                        <input type="radio" class="radio" id="{{i}}" name="{{i}}"
                                                            disabled>
                                                        <span class="label">
                                                            <input type="text" class="form-control d-inline-block mb-2"
                                                                formControlName="questionAnswer"
                                                                placeholder="Enter Option (Required)"
                                                                (input)="checkIfNoneOrOthers(j, i);quesUpdated(i)">
                                                        </span>
                                                        <validation-message [control]="opt.controls.questionAnswer">
                                                        </validation-message>
                                                    </label>
                                                </div>

                                                <div class="checkbox-wrapper" *ngIf="ques.value.questionTypeId == 3">
                                                    <label>
                                                        <input type="checkbox" class="check checkbox-width-20"
                                                            disabled />
                                                        <span class="label">
                                                            <input type="text" class="form-control d-inline-block mb-2"
                                                                formControlName="questionAnswer"
                                                                placeholder="Enter Option (Required)"
                                                                (input)="checkIfNoneOrOthers(j, i);quesUpdated(i)">
                                                        </span>
                                                        <validation-message [control]="opt.controls.questionAnswer">
                                                        </validation-message>
                                                    </label>
                                                </div>
                                            </div>
                                            <!-- To add image to option start -->
                                            <div class="col-2 mb-3" *ngIf="ques.value.questionTypeId != 1">
                                                <div class="checkbox-wrapper">
                                                    <label>
                                                        <input type="checkbox" class="check checkbox-width-20"
                                                            formControlName="isOptImg"
                                                            (change)="removeQuesAnsImg(j, i)" />
                                                        <span class="label">
                                                            Add Image
                                                        </span>
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="col-12 mb-3 px-0"
                                                *ngIf="addQuesForm.value.questions[i].questionAnswerOptions[j].isOptImg">
                                                <app-file-upload formControlName="file" [fileLength]="1"
                                                    [validTypes]="['jpg', 'jpeg', 'png', 'svg']"
                                                    [filesUploaded]="opt.value.optImg"
                                                    (selectedItem)="selectQuesAnsFileResult($event, j, i)">
                                                </app-file-upload>
                                            </div>
                                            <!-- To add image to option end -->
                                            <div class="col-4 mb-2 pl-0" *ngIf="ques.value.questionTypeId != 3">
                                                <div class="checkbox-wrapper">
                                                    <label>
                                                        <input type="checkbox" class="check checkbox-width-20"
                                                            formControlName="submitQuestionnaire"
                                                            (change)="checkIfAllOptionsSelectedForSubmit('addQues', j, i);quesUpdated(i)" />
                                                        <span class="label">
                                                            Submit Questionnaire
                                                        </span>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col p-1 m-auto">
                                        <div class=" card icon-card-list red-bg mr-1" title="Remove"
                                            *ngIf="addQuesForm.value.questions[i].questionAnswerOptions.length > 1">
                                            <span class="pointer-cursor size-15" title="Remove"
                                                (click)="removeQuesAns('addQues', j, i)">-</span>
                                        </div>

                                        <div class="card icon-card-list blue-bg" title="Add"
                                            *ngIf="(j + 1 == ques.value.questionAnswerOptions.length - 2)">
                                            <!-- j + 1 == opt.value.length - 2 indicates last option other than "others, specify and none of the above" -->
                                            <span class="fa fa-plus pointer-cursor size-14" style="color:white;"
                                                title="Add" (click)="addQuesAns('addQues', i)"></span>
                                        </div>
                                    </div>
                                </div>
                                <!-- For the options "others, specify and none of the above" - we have to disable the options and should not allow the actions like add and remove at the end of the option -->
                                <div class="row"
                                    *ngIf="(opt.value.questionAnswer == otherSpecifyText || opt.value.questionAnswer == noneOfTheAboveText && (ques.value.questionTypeId == 1 || ques.value.questionTypeId == 2 || ques.value.questionTypeId == 3))"
                                    [formGroupName]="j">
                                    <div class="col-11 ml-3">
                                        <div class="row mx-2 px-3 option-border">
                                            <div class="px-0 mb-3 col-10 pr-2">
                                                <div class="checkbox-wrapper">
                                                    <label>
                                                        <input type="checkbox" formControlName="isOption"
                                                            class="check checkbox-width-20"
                                                            (change)="quesUpdated(i); noneOrOthers('addQues', j, i)" />
                                                        <span class="label">
                                                            <input type="text" class="form-control d-inline-block mb-2"
                                                                formControlName="questionAnswer" disabled>
                                                        </span>
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="col-4 mb-2 pl-0"
                                                *ngIf="opt.value.isOption && opt.value.questionAnswer == noneOfTheAboveText && ques.value.questionTypeId != 3">
                                                <div class="checkbox-wrapper">
                                                    <label>
                                                        <input type="checkbox" class="check checkbox-width-20"
                                                            formControlName="submitQuestionnaire"
                                                            (change)="checkIfAllOptionsSelectedForSubmit('addQues', j, i);quesUpdated(i)" />
                                                        <span class="label">
                                                            Submit Questionnaire
                                                        </span>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- slider -->
                                <div class="row" *ngIf="ques.value.questionTypeId == 6" [formGroupName]="j">
                                    <div class="col-11">
                                        <div class="dropdown slider">
                                            <label class="ml-4">
                                                <input type="text" class="form-control d-inline-block mb-2"
                                                    formControlName="questionAnswer" (input)="quesUpdated(i)"
                                                    placeholder="Enter Option (Required)">
                                                <validation-message [control]="opt.controls.questionAnswer">
                                                </validation-message>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Textbox, textarea and date options -->
                            <div class="row"
                                *ngIf="ques.value.questionTypeId == 4 || ques.value.questionTypeId == 5 || ques.value.questionTypeId == 9">
                                <div class="col-11">
                                    <div class="text" *ngIf="ques.value.questionTypeId == 4">
                                        <label class="ml-4">
                                            <input type="text" class="form-control d-inline-block" disabled>
                                        </label>
                                    </div>

                                    <div class="text" *ngIf="ques.value.questionTypeId == 5">
                                        <label class="ml-4">
                                            <textarea class="form-control d-inline-block" disabled></textarea>
                                        </label>
                                    </div>

                                    <div class="text" *ngIf="ques.value.questionTypeId == 9">
                                        <label class="ml-4">
                                            <input type="text" placeholder="MM-DD-YYYY"
                                                class="form-control d-inline-block" disabled>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <!-- Image and video options -->
                            <div class="row" *ngIf="ques.value.questionTypeId == 7 || ques.value.questionTypeId == 8">
                                <div class="col-12 upload">
                                    <app-file-upload [disableBtn]="true"></app-file-upload>
                                </div>
                            </div>
                        </div>
                        <div class="ques-footer p-3">
                            <div class="row">
                                <div class="col-6">
                                    <div class="checkbox-wrapper">
                                        <label>
                                            <input type="checkbox" class="check checkbox-width-20"
                                                formControlName="isMandatory" (change)="quesUpdated(i)" />
                                            <span class="label">
                                                Mark this question as mandatory
                                            </span>
                                        </label>
                                    </div>
                                </div>
                                <div class="col-6" *ngIf="!(editFlag && ques.value.questionId)">
                                    <div class="checkbox-wrapper">
                                        <label>
                                            <input type="checkbox" class="check checkbox-width-20"
                                                formControlName="saveForFuture" />
                                            <span class="label">
                                                Save this question for future use
                                            </span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-1 mt-2">
                    <div class="card icon-card-list red-bg mr-1" title="Remove">
                        <span class=" pointer-cursor size-15" title="Remove" (click)="removeQues(i)">-</span>
                    </div>

                    <div class="card icon-card-list blue-bg" title="Add" *ngIf="last">
                        <span class="fa fa-plus pointer-cursor size-14" style="color:white;" title="Add"
                            (click)="addQues()"></span>
                    </div>
                </div>
            </div>
        </form>

        <div class="text-center" *ngIf="addQuesForm.value.questions.length === 0">
            <button class="btn btn-primary" type="button" (click)="addQues()">Add Question</button>
        </div>
    </div>

    <div class="row">
        <div class="col-12 mt-3">
            <div class="float-right">
                <button class="btn btn-secondary" type="button" (click)="back()">Back</button>&nbsp;&nbsp;
                <button class="btn btn-primary" type="button" (click)="next()">Next</button>
            </div>
        </div>
    </div>
</div>